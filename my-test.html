<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>test</title>
 	<!-- bootstrap css cdn -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <!-- bootstrap js cdn -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <!-- Option 1: Include in HTML -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
   
  <!--popup model bootstrap js -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
  <!-- sweet alert cdn -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js" integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://js.zohostatic.com/creator/widgets/version/1.0/widgetsdk-min.js"></script>

 
	<style type="text/css">

		.zc-pb-formreport-placeholder{
			height: 600px !important;
		}
		.overlay {
	    background-color:#EFEFEF;
	    position: fixed;
	    width: 100%;
	    height: 100%;
	    z-index: 1000;
	    top: 0px;
	    left: 0px;
	    cursor: none;
	    pointer-events: none;
	    opacity: .5; /* in FireFox */ 
	    filter: alpha(opacity=50); /* in IE */
		}
		*{
			box-sizing: border-box;
	    font-family: "Ariel",sans-serif;
		}
		.zpelement-wrapper{
			max-height: 100%;
			height: 100%;
		}
		.addtoCart{
			background:black;
			color: #fff;
			justify-content: center;
			width: 100%;
			margin-top:auto;
			margin-top:1em;
		}
		.addtoCart:hover{
			background: orange;
			color: black;
			/*font-weight: 600;*/
	    border-radius: 18px;
		}
		.productCard:hover{
	    opacity: 1;
	  } 
	    
	  .productCard{
	  	box-shadow: 0 0 15px rgba(0, 0, 0, 0.30);
	  	margin-top: 1em;
	  	height:auto;
	  	align-items: stretch;
	  }
	  .productName
	  {
	  	font-weight: bold;
	  	font-size: .8rem;
	  	height:36px;
	  	align-items:center;
	  	justify-content:center;
	  	/*overflow:auto;*/
	  	/*margin-top:auto;*/	
	  }
	  .productName::-webkit-scrollbar {
	    width: 2px;
	  }
	    
	  .productName::-webkit-scrollbar-track {
	    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.9); 
	    border-radius: 10px;
	  }
	    
	  .productName::-webkit-scrollbar-thumb {
	    border-radius: 10px;
	    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); 
	  }
	  .productCard h6{
	  	color: black;
	  }
	  .productCard:hover h6{color: black;}
	  .wg-box-content-details h3{
	    color: red;
	    font-weight: 500;
	    margin-bottom: 0.5em;
	    text-transform: uppercase;
	  }
	  .productImage{
	    background-repeat: no-repeat;
	    background-size: contain;
	    background-position: center;
	    margin-bottom: .9rem;
	  }
	 	.productImage{
	 		margin-top: auto;
	 	}
	  .productImage img{
	  	width: 100%;
	    aspect-ratio: 3/2;
	    object-fit: contain;
	    border-radius: 10px;
	  }
	  .badge{
	  	font-size: .8em;
	  	color: black;
	  	background: #FFCCCB;
	  	margin-top: auto;
	  }
	  .productPrice{
	  	font-size: .9rem;
	  	padding-top: .8rem;
	  	font: bolder;
	  }
	  .productPrice span{
	    color: blue;
	    font-size:.8rem;
	  }
	  .navbar{
	    width: 100%;
	  	box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
	  	position: sticky;
	  	display: flex;
	  	top: 0;
	  	z-index: 999;
	  	overflow: hidden;
	  	height: fit-content;
	  	/*line-height: 10px;*/
	  	align-items: center;
	  }
	  .navbar-brand {
	  	width: 4rem;
	  }
	  nav .search-bar{
	  	width: 40%;
	  }
	 	.search-bar input{
		  border-radius: 24px;
		  background: black;
		  color: whitesmoke;
		  text-align: center;
	  }
	 
	 	.search-bar input:focus{
	    background: black;
	    color: whitesmoke;
	    text-align: center;
	    cursor: pointer;
	  }
	  input[type="search"]::-webkit-search-cancel-button {
			/*      -webkit-appearance: none;*/
	  }    
	  .menu-btn button i{
	  	width: auto;
	  	font-size: 1.3em;
	  	justify-content: center;
	  	font: bolder;
	  	color: black;
	  	border: none;
	  	outline: none;
	  }
	  .menu-btn button:hover{
	  	outline: none;
	  	border: none;
	  	background: orange;
	  	color white
	  }
	  .item-count{
	    top: 13px;
	    right: 1px;
	    justify-content: center;
	    position: fixed;
	    background: black;
	    color:white;
	    border-radius: 50%;
	    text-align: center;
	    padding-left: 8px;
	    padding: 4pxs;
	    padding-right: 8px;
	    vertical-align: middle;
	    font-size: .9rem;
	  }
	  /*.tick-icon {*/
	  /*    margin-right:3px;*/
	  /*    float:right;*/
	  /*    color: black;*/
	  /*    display:none;*/
	  /*    font:boler;*/
	  /*    font-weight:600;*/
	  /*}*/
	  .productCard .filtered {
	    order: -1;
	  }
	    
	  .qty-section input:focus{
	    border: 1px solid blue;
	  }
	     
	  .menu-btn .bi-person-circle{
 	    padding-right: 13px;
	    top:10px;
    }

	  @media (max-width:600px){

	  }
	  @media (max-width:480px){
    	*{
      	box-sizing:border-box;
        margin:auto;
        padding:auto;
	    }
	    .navbar-brand{
	      width:15%;
	      aspect-ratio:2/2;
	    }
	    nav .search-bar{
        width: 50%;
      }
 			.menu-btn .bi-person-circle{
        padding-right: auto;
        padding-left: 6px;
      }
	  }
	</style>   
</head>
<body>
	<!-- onload model start -->
	<div class="modal fade" id="exampleModalToggle" aria-hidden="false" data-bs-backdrop="static" data-bs-keyboard="false" >
  	<div class="modal-dialog modal-dialog-centered">
    	<div class="modal-content">
      	<div class="modal-header">
        	<h5 class="modal-title" id="exampleModalToggleLabel">ITEMS CATEGORY</h5>
        	<!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
      	</div>
      	<div class="modal-body">
      		<select class="form-select brandtype" aria-label="Default select example">
	      		<option value="1">Pasumpal Ice cream </option>
	      		<option value="2">Sweets & Savouries</option>
	      	</select>
	      </div>
	      <div class="modal-footer">
	        <button class="btn btn-primary modelproceed" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal" data-bs-dismiss="modal">Continue</button>
	      </div>
	    </div>
	  </div>
	</div>
	<!-- onload model ends -->


	<div class="enabledisable ">
		<nav class="navbar navbar-light bg-light" style="background-color: #c8c8c9;">
    	<div class="container-fluid">
        <img src="karupatti-logo.png" class="navbar-brand">
        <form class="d-flex input-group search-bar rounded">
          <input type="search" class="form-control searchBar" placeholder="Search" aria-label="Search" aria-describedby="search-addon"/>
          <!-- <i class="bi bi-x search-cancel" ></i> -->
        </form>
        <span class="menu-btn">
        	<i class="bi bi-person-circle customerdetails" data-toggle="tooltip" data-placement="bottom" customerid='' title="" style="font-size: 2rem;align-items: flex-end;justify-content: center;margin-top: 4px;cursor: pointer;color: black;"></i>
        	<button class="btn btn-warning border-0"><i class="bi bi-cart"><span class="item-count">0</span></i></button>
    		</span>
  		</div>
		</nav>
		<div id="content" class="container mt-4" style="justify-content:center;align-self: auto;align-items: flex-start;">
  		<div id="" class="page hide card-container" style="display: block;justify-content: space-between;">
    		<div class="row productsection">
      		<!-- Product data goes here     -->

      		<!-- <div class="col-lg-4 col-md-6 col-sm-10 col-12 parentFilter">
            <div class="card border-0 productCard bg-white box">
            	<div class="card-body p-2">
                <div class="row">
                  <div class="col-7">
                    <h6 class="productName mb-1">Coffee Flavored Food Products</h6>
                    <h6 class="productPrice "><span>INR</span> 12.00</h6>
                    <h6 class="sNo text-muted mb-0 p-2">
                      <span class="badge badge-danger stock">2 in Stock</span>
                    </h6>
                    <div style="display:flex;" class="qty-section">
                      <button class="btn btn-dark btn-sm btn-minus border-0" value="-">-</button>
                      <input type="number" name="number" class="qty" value="0" style="width:55px;">
                      <button class="btn btn-dark btn-sm btn-plus" value="+">+</i></button>
                    </div>
                  </div>
                  <div class="col-5">
                    <div class="productImage product_3">
                    	<img src="https://hips.hearstapps.com/delish/assets/cm/15/10/54f64ff90a76e_-_coffee-almonds-blue-diamond-de.jpg">
                    </div>
                    <div class="mt-4">
                    	<button class="btn btn-sm addtoCart btn-block">Add to Cart
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        	</div> -->

    		</div>
			</div>
		</div>
		<!-- </div> -->
		<style type="text/css">



			.loader_val {
	      width: 100px; /* control the size */
	      aspect-ratio: 8/5;
	      --_g: no-repeat radial-gradient(#000 68%,#0000 71%);
	      -webkit-mask: var(--_g),var(--_g),var(--_g);
	      -webkit-mask-size: 25% 40%;
	      background: black;
	      animation: load 1s infinite;
	    }
	    @keyframes load {
	      0%    {-webkit-mask-position: 0% 0%  ,50% 0%  ,100% 0%  }
	      16.67%{-webkit-mask-position: 0% 100%,50% 0%  ,100% 0%  }
	      33.33%{-webkit-mask-position: 0% 100%,50% 100%,100% 0%  }
	      50%   {-webkit-mask-position: 0% 100%,50% 100%,100% 100%}
	      66.67%{-webkit-mask-position: 0% 0%  ,50% 100%,100% 100%}
	      83.33%{-webkit-mask-position: 0% 0%  ,50% 0%  ,100% 100%}
	      100%  {-webkit-mask-position: 0% 0%  ,50% 0%  ,100% 0%  }
	    }
	    .loader_div{
	      margin:0;
	      top: 0px;
	      display:flex;left: 0px;
	      right: 0px;
	      height: 100%;
	      text-align: center;
	      justify-content: center;
	      align-items: center;
	      z-index: 999;
	      position: absolute;
	      background: rgba(0, 0, 0, 0.5);
	    }
    	.header{
        width:100%;
    	}
	    .header p{
        font-weight:600;
	    }
    	.cart-bag{
        display: none;
        min-height:100vh;
        max-width: 420px;
        box-shadow:0 0 17px rgba(0,0,0,0.39);
        float:right;
        justify-content:center;
        align-item:center;
        box-shadow:border-box;
        border-radius:15px;
        color :black;
        top: 0;
        right: 0;
        z-index:999;
        position: fixed;
    	}
    	.cart-bag .header{
        margin-top:1.5em;
        justify-content:center;
        align-items:center;
        text-align:center;
        margin-bottom:0;
    	}
      
    	.cart-table td i{
        font-size:.8rem;
    	}
    	.cart-table button:hover{
        background:orange;
    	}
    	.cart-section{
        background:white; 
        padding:.5rem;
        height:50vh;
        overflow:auto;
        overflow-x:hidden;
        overflow-y:auto;
        justify-content: center;
    	}
    	.cart-row{
        wdith:100%;
        background:#6F4E37;
        color:white;
        margin-top:.1rem;
        padding: 10px;
        border-radius:5px;
        border-bottom:1px solid black;
        justify-content:center;
        align-items:center;
    	}
    	.cart-row  h6{
        font-size:.8rem;
    	}
    	.cart-row input{
        width:100%;
    	}
    	.cancel-btn .bi-x{
        font-size:1rem;
        line-height:10px;
    	}
    	.cart-section::-webkit-scrollbar {
        width: 6px;
    	}
    	.cart-section::-webkit-scrollbar-track {
    		-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); 
    		border-radius: 10px;
    	}
    	.cart-section::-webkit-scrollbar-thumb {
    		border-radius: 10px;
    		-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); 
    	}
    	.total-section{
		    justify-content:center;
		    align-items:center;
    	}
	    .customer-selection{
		    width:100%;
		    justify-content:center;
		    align-items:center;
		    text-align:cetner;
	    }
	    .form-outline .select_page {
	      font-size:2em; 
	    }
	    .pay-btn{
        justify-content:center;
        display:flex;
        margin-top:1em;
        align-items:center;
	    }
	    .pay-btn button{
        font-size:1.3rem;
        width:90%;
        border-radius:10px;   
	    }
	    .pay-btn button:hover{
        background:green;
        color:white;
	    }
		  .header .bi-arrow-left{
	      display: block;
	      font-size: 1.2rem;
	      line-height: 10px;
	      font-weight: 650;
	      font: bold;
		  }
	    /* .bi-arrow-left:hover{
        font-size:.8rem;
	    }    */
	    .product-image img{
        width: 100%;
	    }    
	  	.cart-section{
        background:black;
        background-image: url(https://www.nithrabooks.com/images/empty-cart-icon.png);
        background-repeat: no-repeat;
        background-position: center;
        background-size: 40%;
        padding:.5rem;
        height:50vh;
        overflow:auto;
        overflow-x:hidden;
        overflow-y:auto;
        border-top:1px solid green;
        padding: 3px;
	    }
	    .cart-section table tbody tr td{
        border-bottom:1px dashed black;
        background:white;
        color:black;
        padding:7px;
        font-size:12px;
        justify-content:center;
        align-items:left;
        align-items: center;
	    }
    
	    .cart-section img{
        width:100%;
	    }
		  .qty-section{
		    display:flex;
		    float:left;
			}
		  .cancel-btn .bi-x{
		    font-size:1rem;
		    line-height:10px;
		  }
    	.cart-section::-webkit-scrollbar {
        width: 6px;
    	}
	    .cart-section::-webkit-scrollbar-track {
		    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); 
		    border-radius: 10px;
	    }
	    .cart-section::-webkit-scrollbar-thumb {
		    border-radius: 10px;
		    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); 
	    }
	    .select2-container .select2-selection {
       	border-radius:10px;
       	border-color: rgba(126, 239, 104, 0.8);
       	background: ghostwhite;
      	color: black;
	      font: bold;
	      outline: 0 none;
	    }
	    .add-customer{
        font-size: .8rem;
	    }
    
		  @media (max-width:760px){
		    .header .bi-arrow-left{
	        display: block;
	        font-size: 1rem;
	        line-height: 10px;
	        font-weight: 650;
	        font: bold;
		    }
		  }

		  @media (max-width:480px){
		    .header .back-to-card{
	        display: block;
	        font-size: 28px;
	        line-height: 10px;
	        font-weight: 650;
	        font: bold;
	        font-size: .8rem;
		    } 
		  }

		  .freeze{
		  	pointer-events: none;
		  }
		  .move{
		  	pointer-events: auto;
		  }
		</style>



		<!-- Customer Modal Part starts here -->
		<div class="modal" id="add-customer-form" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" >
    	<div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add Customer</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-12 mb-4 justify-content-center">
                <div class="card-body">
                  <form>
                    <div class="row mb-4">
                      <div class="col">
                        <div class="form-outline">
                          <input type="text" id="form7Example1" class="form-control" />
                          <label class="form-label" for="form7Example1">First name</label>
                        </div>
                      </div>
                      <div class="col">
                        <div class="form-outline">
                          <input type="text" id="form7Example2" class="form-control" />
                          <label class="form-label" for="form7Example2">Last name</label>
                        </div>
                      </div>
                    </div>
                    <div class="form-outline mb-1">
                      <input type="text" id="form7Example3" class="form-control" />
                      <label class="form-label" for="form7Example3">Company name</label>
                    </div>
                    <div class="form-outline mb-1">
                      <input type="text" id="form7Example4" class="form-control" />
                      <label class="form-label" for="form7Example4">Address</label>
                    </div>
                    <div class="form-outline mb-1">
                      <input type="email" id="form7Example5" class="form-control" />
                      <label class="form-label" for="form7Example5">Email</label>
                    </div>
                    <div class="form-outline mb-1">
                      <input type="text" id="form7Example5" class="form-control" />
                      <label class="form-label" for="form7Example5">Phone</label>
                  	</div>
                    <div class="form-outline mb-1">
                      <textarea class="form-control" id="form7Example7" rows="4"></textarea>
                      <label class="form-label" for="form7Example7">Additional information</label>
                    </div>
                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary cancel-adding" data-bs-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-primary adding-customer">Add</button>
                </div>
              </div>
            </div>
          </div>
  	    </div>
	    </div>
		</div>
		<!-- Customer Modal Part ends here -->

 		<div class="cart-bag col-lg-4 col-sm-7 col-md-6 col-12 bg-light" >
    	<div class="container ">
        <div class="header row justify-content-center">
          <div class="col-2 mb-auto justify-content-center">
            <button class="btn btn-primary btn-md back-to-card"><i class="bi bi-arrow-left"></i></button>
          </div>
          <div class="col-6">
            <p>Product Cart</p>
          </div>
          <div class="col-4 mb-auto">
            <button class="btn btn-danger btn-sm clear-btn">Clear All</button>
          </div>
        </div>
        <!-- <div class="customer-selection d-flex mt-1">
          <div class="form-outline">
            <select id="select_page" class="operator form-control CustomerRow" style="width:270px;padding: 8px;border-radius: 4px;border: 1px solid blue;"> 
              <option value="0" disabled selected>Select customers...</option>

            </select>
            <button type="button" class="btn btn-secondary btn-sm add-customer" data-bs-toggle="modal" data-bs-target="#add-customer-form">
            	<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-person-fill-add" viewBox="0 0 16 16">
              	<path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Zm-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
              	<path d="M2 13c0 1 1 1 1 1h5.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.544-3.393C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4Z"/>
              </svg>
            </button>
          </div>
        </div> -->
        <section class="mt-2 cart-section">
          <table id="cart-items">
            <tbody id="cart-body">
             	<!-- Cart Item Goes here -->
            </tbody>
          </table>
        </section>
        <div class="total-section mt-3">
          <div class="row mt-1">
          	<div class="col" style="text-align:right;">Subtotal</div>
          	<div class="col" style="text-align:right;font:bolder;font-weight:580;color: green;">INR
            	<span style="color:black;font:bolder;" class="sub-total">0.00</span>
          	</div>
          </div>
          <div class="row mt-1"  style="display: none;">
            <div class="col" style="text-align:right;">Discount</div>
            <div class="col" style="text-align:right;font:bolder;font-weight:580;">(%)
            	<input type="number" name="number" class="btn btn-sm discount" value="0" style="width:35%">
            </div>
          </div>
          <div class="row mt-1">
            <div class="col" style="text-align:right">Total Amount</div>
            <div class="col" style="text-align:right;font:bolder;font-weight:580;color: green;">INR
              <span style="color:black;font: bolder;" class="total-Amount">0.00</span>
            </div>
          </div>
          <div class="row mt-1" style="display: none;">
            <div class="col" style="text-align:right">Available Credits</div>
            <div class="col" style="text-align:right;font:bolder;font-weight:580;color: green;">INR
              <span style="color:black;font: bolder;" class="old_credit_amount">0.00</span>
            </div>
          </div>
		  <div class="row mt-1" style="display: none;">
            <div class="col" style="text-align:right">Old Sweet Credits</div>
            <div class="col" style="text-align:right;font:bolder;font-weight:580;color: green;">INR
              <span style="color:black;font: bolder;" class="old_credit_amount_sweet">0.00</span>
            </div>
          </div>
          <div class="row mt-1">
            <div class="col" style="text-align:right">Shipping Charges</div>
            <div class="col" style="text-align:right;font:bolder;font-weight:580;color: green;">INR
              <span style="color:black;font: bolder;" class="old_shipping_charge">0.00</span>
            </div>
          </div>
        </div>
        <div class="pay-btn">
          <button class="btn btn-warning paid-btn">Place Order INR<span class="pay-amount">00.0</span></button>
        </div>
      </div>
  	</div>
  </div>
  <!-- Onload page loader -->
  <div class="loader_div" style="display: none;">
    <div class="loader_val"></div>
  </div>
  <!-- Onload page loader ends -->
</body>
<script>

	function getDayOfWeek() {
  	const date = new Date();
  	console.log("Current Date :  ",date.getDay());
  	// alert(date.getDay());
	  return date.getDay(); // Returns the day of the week as a number (0 for Sunday, 1 for Monday, ..., 6 for Saturday)
	}

	function isOdd(day) {
	  return day % 2 !== 0;
	}

	function isEven(day) {
	  return day % 2 === 0;
	}

	function getOddEvenDay() {
	  const dayOfWeek = getDayOfWeek();
	  
	  // Exclude Sunday (0) from the calculation
	  if (dayOfWeek === 0) {
	    return "Sunday";
	  } else if (isOdd(dayOfWeek)) {
	    return "odd";
	  } else if (isEven(dayOfWeek)) {
	    return "even";
	  }
	}

	$(window).on('load', function() {

  	$('#exampleModalToggle').modal('show');
	});
	var EnableOutstanding="false";
	var CustomerLocation="";
	var TotalOutStandingAmount=0.00;
	var customerCreditAmount=0.00;

	var listVal="";


// diabled the quantity section based on the qty starts

// const allCards = $(".parentFilter");
// allCards.each(function(){
// 	var qty_row = $(this).find('.qty-section');

// 	var quantity_val = qty_row.find('.qty').val();

// 	if(quantity_val <= 0){
// 		$(this).addClass("freeze");
// 		$(".addtoCart").addClass("move");
// 	}
// 	else{
// 		$(this).addClass("move");
// 		$(".addtoCart").addClass("move");
// 	}
// });
// ends
	// $(".loader_div").show();

	$(document).delegate('.modelproceed', 'click', function(){
		var brandVal=$(".brandtype option:selected").text();
		console.log("brandVal:",brandVal);
		// getProductFunc(brandVal);
		getCustomerFunc(brandVal).then(dataval=>{
			console.log("data:",dataval);
			console.log("Brand: >>>",brandVal);
			const result = getOddEvenDay();
			let current_date = new Date();
			let current_day = current_date.getDay();
			console.log("result:",result);
			var customer_id=dataval.customerid;
			console.log("customer_id:",customer_id);
			console.log("dataval.area:",dataval.area);
			var finalstage=false;
			if (dataval.area=="LOCAL" && brandVal.trim() == "Pasumpal Ice cream" && (current_day == 2 || current_day == 4 ) )
			{
				finalstage=true;
			}
			else if (dataval.area=="LOCAL" && brandVal.trim() == "Sweets & Savouries" && (current_day == 2 || current_day == 4 || current_day == 6 ) )
			{
				finalstage=true;
			}
			else if (dataval.area!="LOCAL" && brandVal.trim() == "Pasumpal Ice cream" && (current_day == 1 || current_day == 5 || result == "Sunday"))
			{
				finalstage=true;
			}
			else if (dataval.area!="LOCAL" && brandVal.trim() == "Sweets & Savouries" && (current_day == 1 || current_day == 3 || current_day == 5 || result == "Sunday"))
			{
				finalstage=true;
			}
			console.log("finalstage:",finalstage);
			//finalstage=true;
			if (finalstage==true || finalstage==false)
			{
				OutStandingPOFunc(customer_id).then(data=>{
				console.log("data:",data);
				var OutStandingAmount=data.OutStanding_Amount || 0;
				var OutStandingAmount_sweet = data.Sweets_Savouries_Outstanding_Amount || 0;
			    var customerLocation=data.Location;
			    var creditoption=data.Enable_Outstanding;
			    var customerCreditAmount=data.Available_Credit;
			    var boxoutstanding=data.Remaining_Box || 0;
				console.log("OutStandingAmount_sweet",OutStandingAmount_sweet);
			    console.log("OutStandingAmount:",OutStandingAmount);
			    console.log("creditoption:",creditoption);


			    // OutStandingAmount validation part
			    	if (OutStandingAmount <= 0 && brandVal.trim() == "Pasumpal Ice cream")
			    	{
						console.log("boxoutstanding:",boxoutstanding)

			    		if (boxoutstanding == 0 || brandVal.trim()=="Sweets & Savouries")
					    {
					    	console.log("create order");
				    		OrderQtyFunc().then(data=>{
									console.log("data resp:",data);
									getProductFunc(brandVal,data,customerLocation);
									listVal=data;
								});
					    }
					    else
					    {
					    	$(".loader_div").hide();
					    	$(".enabledisable").addClass("overlay");
								Swal.fire({
								  position: 'center',
								  icon: 'warning',
								  text:boxoutstanding+" boxes need to be returned",
								  showConfirmButton: false,
								  timer: 2500
								})
					    }
			    	}
					
					else if(OutStandingAmount_sweet <= 0 && brandVal.trim()=="Sweets & Savouries")
					{
						console.log("create order sweet");
				    		OrderQtyFunc().then(data=>{
									console.log("data resp:",data);
									getProductFunc(brandVal,data,customerLocation);
									listVal=data;
								});
					}
			    	else
			    	{
		    			$(".loader_div").hide();
		    			if(brandVal.trim()=="Pasumpal Ice cream")
						{
							console.log("############");
							Swal.fire({
							  position: 'center',
							  icon: 'warning',
							  title: 'OutStanding Amount Found',
							  text:"Out Standing Amount is: "+OutStandingAmount,
							  showConfirmButton: false,
							  timer: 2500
							})
						}
						else if(brandVal.trim()=="Sweets & Savouries")
						{
							console.log("**********************");
							Swal.fire({
							  position: 'center',
							  icon: 'warning',
							  title: 'OutStanding Amount Found',
							  text:"Out Standing Amount is: "+OutStandingAmount_sweet,
							  showConfirmButton: false,
							  timer: 2500
							})
						
						}
						console.log("$$$$$$$$$$$$$$")
		    		
		    			// customerLocation validation part ends here
			    	}
			    	// OutStandingAmount validation part ends here
				});
			}
			else
			{
				Swal.fire({
				  position: 'center',
				  icon: 'warning',
				  title: 'Please Try to place Order Tomorrow',
				  showConfirmButton: false,
				  timer: 1500
				})
			}
		});
	});

	// Check current time with given time 
	function isTimeGreaterThanCurrent(timeString,ampm) {
	  var currentTime = new Date(); // Get current time
	  var givenTime = new Date(); // Create new Date object for given time

	  // Parse the given time in HH:mm format
	  var timeParts = timeString.split(':');
	  givenTime.setHours(parseInt(timeParts[0], 10));
	  givenTime.setMinutes(parseInt(timeParts[1], 10));

	  console.log("givenTime:",givenTime);

	  // Compare the two Date objects
	  if (ampm=="am")
	  {
	  	// Compare the two Date objects
	  	return givenTime >= currentTime;
	  }
	  else
	  {
	  	// Compare the two Date objects
	  	return givenTime <= currentTime;
	  }
	}
	// Check current time with given time ends here

	// function related to creator part


	// Get order Qty Details Data starts here
	async function OrderQtyFunc(){
		var listData=[];
		try
		{
			console.log("OrderQtyFunc called");
			var query_params = ZOHO.CREATOR.UTIL.getQueryParams();
			var useremail=query_params.email;
			console.log("useremail:",useremail);
			var orderConfig = { 
	      reportName : "QTY_Details_Line_Item_Report",
	      criteria : '(Order_QTY_Details_ID.Email == "'+useremail+'")', 
	      page : 1,
	      pageSize : 200
	  	}
	  	const orderQtyResp = await ZOHO.CREATOR.API.getAllRecords(orderConfig);
	    const recordArr1 = await orderQtyResp.data;
	    console.log("recordArr:",recordArr1);
	    for(var index in recordArr1)
	    {
	    	var productID=recordArr1[index].Product_Name.ID;
	    	var productqty=recordArr1[index].QTY;
	    	var temp_arr=[];
	      temp_arr["productID"]=productID;
	      temp_arr["Qty"]=productqty;
	  		listData.push(temp_arr);
		  }
	    return listData;
		}catch(error){
			console.log("errorRes:",error);
			return listData;
		}
		
	}

	// Get order Qty Details Data ends here

	function findArrayByKeyValue(keyName, value, group) {
    for (let i = 0; i < group.length; i++) {
      if (group[i].hasOwnProperty(keyName) && group[i][keyName] === value) {
        return group[i];
      }
    }
    return null;
  }
// validate the product card add to cart button script start
  async function validateAddToCartButton() {
  	return new Promise((resolve) => {
  		$(".parentFilter").each(function () {
  			var actualStock = parseInt($(this).find('.astock').text());
      	console.log("THIS CARD ACTUAL STOCK IS :", actualStock);
      	var addToCartButton = $(this).find('.addtoCart');
      	setTimeout(() => {
      		if (actualStock <= 0) {
      			addToCartButton.prop('disabled', true);
      			console.log("THIS CARD BUTTON WILL BE DISABLED ");
      		} else {
      			addToCartButton.prop('disabled', false);
          	console.log("THIS CARD BUTTON WILL BE ENABLED ");
          }
          resolve();
        }, 1000);
      });
  	});
  }

	// validate the product card add to cart button script ends

	// product
	async function getProductFunc(brandData,listdata,customerLocation){
		console.log("getProductFunc called:",customerLocation);
		console.log("listdata:",listdata);
		var ListValue=listdata;
		try{
			// alert("getProductFunc called");
			var idcount=1;
			for (var i = 1; i <=2; i++)
			{
				// alert("getProductFunc i val:"+i);
				var samplebrand="Pasumpal Ice cream";
				var proConfig = { 
	        reportName : "All_Products1",
	        criteria : '(Brand == "'+brandData.trim()+'" && Is_Visible=="Yes")', 
	        page : i,
	        pageSize : 200
	    	}
	    	const productResp = await ZOHO.CREATOR.API.getAllRecords(proConfig);
	      const recordArr = await productResp.data;
	      console.log("recordArr:",recordArr);
	      var rowCount=0;
	      for(var index in recordArr)
	      {
	      	var image = recordArr[index].Item_Image;
	      	var itembrand=recordArr[index].Brand;

	      	var recID=recordArr[index].ID;

	      	var url="";
	        if (image=="") 
	        {
	          url="https://cdn.iconscout.com/icon/premium/png-256-thumb/best-product-3102470-2583790.png";
	        }
	        else
	        {
	        	url="https://zohoprintengine.com/nkc_foods/images/"+recID+".jpg";
	          // url="https://creatorapp.zoho.in"+image;
	        }
	        var ItemName = recordArr[index].Item_Name;
	        var productCode=recordArr[index].Product_Code ||0;
	        var price=recordArr[index].Price;
	        console.log("price before:",price);
	        if (itembrand=="Pasumpal Ice cream")
	        {
	        	if (customerLocation=="LOCAL")
		        {
		        	margin=(price * 35)/100;
		        	price=parseFloat(parseFloat(price)- parseFloat(margin)).toFixed(2);
		        	console.log("price after:",price);
		        }
		        else
		        {
		        	margin=(price * 40)/100;
		        	price=parseFloat(parseFloat(price)-parseFloat(margin)).toFixed(2);
		        	console.log("price after:",price);
		        }
	        }
	        var itemUnit=recordArr[index].Unit;
	        var Qty=recordArr[index].Available_Stock ||0;

	        var MaxOrderQty= recordArr[index].Max_Order_Qty;
	        var minQty=recordArr[index].Min_Qty ||0;

	        // var finalQty=Qty - minQty;
	        var finalQty=Qty - 0;
	        console.log("finalQty:",finalQty);
	        // if (finalQty > 0)
	        // {

	        	const dataqty = findArrayByKeyValue('productID', recID, ListValue);
		      	console.log("dataqty:",dataqty);
		      	if (dataqty)
		      	{
		      		var fixedQty=dataqty.Qty;
		      		console.log("fixedQty:",fixedQty);

		        	console.log("qty: ",Qty);
			        var domhtml='<div class="col-lg-4 col-md-6 col-sm-10 col-12 parentFilter"><div class="card border-0 productCard bg-white box"><div class="card-body p-2"><div class="row"><div class="col-7"><h6 class="productName mb-1" maxqty="'+MaxOrderQty+'" minqty="'+minQty+'"  sku='+productCode+' recid='+recID+'>'+ItemName+'</h6><h6 class="productPrice" taxpercentage="7"><span>INR</span> '+price+'</h6><h6 class="sNo text-muted mb-0 p-2"><span class="badge badge-danger btn-block astock" style="background:white;">'+finalQty+' in Stock</span></h6><div style="display:flex;" class="qty-section freeze"><button class="btn btn-dark btn-sm btn-minus border-0" value="-">-</button><input type="number" name="number" class="qty" value="'+fixedQty+'" style="width:55px; text-align:center;" disabled ><button class="btn btn-dark btn-sm btn-plus" value="+">+</i></button></div></div><div class="col-5"><div class="productImage product_3"><img src="'+url+'" id="cardimages'+idcount+'" orginimage = "'+image+'"></div><div class="mt-4"><button class="btn btn-sm addtoCart btn-block">Add to Cart<!--<span class="tick-icon">&#10004;</span>--></button></div></div></div></div></div></div>';

			      	$(".productsection").append(domhtml);
			      	rowCount++;
			      	idcount++;
			         await validateAddToCartButton();
			      	// MB qty validation updated 
			      	// var cancelBtn = $('.btn-minus');
			      	// var addBtn = $('.btn-plus');
			      	// var qtyInput = $('.qty');
			      	// // var qutantity =$('.qty').val();
			      	//  if(fixedQty > 0){
			      	//  	addBtn.addClass("freeze");
			      	//  	$('.qty').attr('disabled','disabled');
			      	//  	cancelBtn.css("pointer-events","none");
			      	//  }
			      	//  else{
			      	//  	addBtn.addClass("move");
			      	//  	cartBtn.addClass("move");
			      	//  	qtyInput.addClass("move");
			      	//  }
		      	}
		      	else
		      	{
		        	console.log("qty: ",Qty);
			        var domhtml='<div class="col-lg-4 col-md-6 col-sm-10 col-12 parentFilter"><div class="card border-0 productCard bg-white box"><div class="card-body p-2"><div class="row"><div class="col-7"><h6 class="productName mb-1" maxqty="'+MaxOrderQty+'" minqty="'+minQty+'"  sku='+productCode+' recid='+recID+'>'+ItemName+'</h6><h6 class="productPrice" taxpercentage="7"><span>INR</span> '+price+'</h6><h6 class="sNo text-muted mb-0 p-2"><span class="badge badge-danger btn-block astock" style="background:white;">'+finalQty+' in Stock</span></h6><div style="display:flex;" class="qty-section"><button class="btn btn-dark btn-sm btn-minus border-0" value="-">-</button><input type="number" name="number" class="qty" value="0" style="width:55px; text-align:center;" disabled><button class="btn btn-dark btn-sm btn-plus" value="+">+</i></button></div></div><div class="col-5"><div class="productImage product_3"><img src="'+url+'" id="cardimages'+idcount+'" orginimage = "'+image+'"></div><div class="mt-4"><button class="btn btn-sm addtoCart btn-block">Add to Cart<!--<span class="tick-icon">&#10004;</span>--></button></div></div></div></div></div></div>';
			      	$(".productsection").append(domhtml);
			      	rowCount++;
			      	idcount++;
			      	await validateAddToCartButton();
		      	}
	        // }
		      	
	      }
	      if (rowCount<200)
	      {
	      	// getImageFunc();
	      	// Function Call 

	      	// Function Call ends 
	      	AddtoCartFunc(listdata);

	      	// getCustomerFunc();
	      	return false;
	      }
			}
		}catch(error){
			console.log("error:",error);
			$(".enabledisable").removeClass("overlay");
			$(".loader_div").hide();
		}
	}

  // Trigger alert when the input quantity reach max of actual product quantity 

  $(document).delegate('.parentFilter .astock, .parentFilter .btn-plus','change keyup click',function(){
  	var currentStock = parseInt($(this).closest('.parentFilter').find('.astock').text()) || 0;
  	var currentInputQty = parseInt($(this).closest('.parentFilter').find('.qty').val()) || 0;

  	if(currentInputQty > currentStock)
  	{
  		Swal.fire({
  			icon: "error",
        text: "Please check the product available stock !",
        showClass: {
        	popup: `
        	  animate__animated
            animate__fadeInUp
            animate__faster `,
            },
            hideClass: {
                popup: `
                  animate__animated
                  animate__fadeOutDown
                  animate__faster`,
            },
        }).then((result)=>{
        	if(result.isConfirmed)
        	{
        		$(this).closest('.parentFilter').find('.qty').val(0);
        	}
        });
  	}

  });
	
// AddtoCartFunc part
	async function AddtoCartFunc(listdata){
		console.log("listdata sp:",listdata);
		$(".productCard").each(function (){
			var recID=$(this).find(".productName").attr("recid");
			console.log("recID",recID);
			const dataqty = findArrayByKeyValue('productID', recID, listdata);
    	console.log("dataqty:",dataqty);
    	if (dataqty)
    	{
    		$(this).find(".addtoCart").text("Added");
		    var productName = $(this).find('.productName').text();
		    var price = $(this).find('.productPrice').text();
		    var actPrice = price.slice(3);
		    var ProductImg = $(this).find('.productImage img').attr('src');
		    var productQty = $(this).find('.qty').val();
		    console.log("productQty:",productQty);

		    var Available_Stock=$(this).find(".astock").text();
		    // console.log("Available_Stock:",Available_Stock);
		    Available_Stock = Available_Stock.replace(/[^0-9]/g,"");
		    // console.log("Available_Stock:",Available_Stock);
		    var MaxQty=$(this).find('.productName').attr("maxqty");
		    // console.log("MaxQty",MaxQty)
		    var recordID=$(this).find(".productName").attr("recid");
		    var recSku=$(this).find(".productName").attr("sku");
		    // console.log("recordID:",recordID);
		    // console.log("recSku:",recSku);
		    var cartBtn = $(this).find('.addtoCart');
		    var tickBtn = $(this).find('.tick-icon');
		    tickBtn.css(
		    {
		      'display':'block',
		      'font-size':'.9rem',
		      'color':'white'
		    }); 
		    cartBtn.css(
		    {
		      'background':'green',
		      'color':'white',
		      'cursor':'pointer',
		      'border-radius':'18px',
		      // 'filter':'blur(.5px)',
		      // 'font-size':'.8rem',
		      'pointer-events': 'none'
		    });
		    $('.tick-icon').fadeOut(3000);
		    // append the items to item cart
		    var cartItems ='<tr class="line_item"><td width=12%><img src='+ProductImg+' /></td><td width=30% ><p class="name" recid='+recordID+'>'+productName+'</p></td><td ><p style="font:bold;font-weight: 580">INR<span class="current-price">'+actPrice+'</span></p></td><td><p class="cart-qty" sku='+recSku+'>'+productQty+'&nbsp;<span style="font:bolder;font-weight: 560;font-size: .8rem;">Kg</span></p></td><td><p style="font:bold;font-weight:690;" >INR<span class="full-price" style="text-align:right;margin-left:2px;">500</span></p></td><td></td></tr>';
		    $('#cart-items #cart-body').append(cartItems);
		   	update_amounts();
    	}
		});

	}
	// AddtoCartFunc part ends
	// Image Part
  async function getImageFunc(){
    var tableRows = document.querySelectorAll(".productCard");
    console.log("tableRows",tableRows);
    var idCount=1;
    tableRows.forEach(function(row) {
    	var idname="";
      // var imageTag = row.querySelector("div #cardimages"+idCount);
      var imageTag = row.querySelector("div #cardimages"+idCount);
      console.log("imageTag:",imageTag);

      var imageFromGetRecordsAPI=imageTag.getAttribute("orginimage");
      // alert("imageFromGetRecordsAPI:"+imageFromGetRecordsAPI);
      if (imageFromGetRecordsAPI!="")
      {
        ZOHO.CREATOR.UTIL.setImageData(imageTag,imageFromGetRecordsAPI);
      }
      console.log("idCount:",idCount);
      idCount++;
    });
  }
  // Image Part ends here

	// Customer
	async function getCustomerFunc(brandVal){
		// alert("getCustomerFunc called");
		console.log("customer function called",brandVal);
		console.log("customer function called",brandVal.trim());
		var query_params = ZOHO.CREATOR.UTIL.getQueryParams();
		var useremail=query_params.email;
		// useremail="info@nkcfoods.com";
		var custConfig={
			reportName : "All_Franchisees",
			criteria : '(User_Email == "'+useremail+'")',
			page:1,
			pageSize:200
		}
		const cust_response = await ZOHO.CREATOR.API.getAllRecords(custConfig);
    const recordArr = await cust_response.data;
    var responsecode=cust_response.code;
    if (responsecode==3000)
    {
    	console.log("cust_response:",cust_response);
      var row_count=0;
      for(var customer in recordArr)
      {
      	customerCreditAmount=recordArr[customer].Credit_limit;
      	EnableOutstanding=recordArr[customer].Enable_Outstanding;
      	var customer_name = recordArr[customer].Customer_Name;
      	var customer_emai=recordArr[customer].Email;
      	var userEmail=recordArr[customer].User_Email;
      	var oldCreditAmount=recordArr[customer].OutStanding_Amount;
		var oldCreditAmount_sweet=recordArr[customer].Sweets_Savouries_Outstanding_Amount;
		console.log("oldCreditAmount_sweet:",oldCreditAmount_sweet);
      	console.log("oldCreditAmount:",oldCreditAmount);
        var customer_id=recordArr[customer].ID;
        var customerLocation=recordArr[customer].Location;
        CustomerLocation=customerLocation;
        var final_customer=customer_name+"&"+customer_id;
        console.log("final_customer:",final_customer);
        var options='<option value="'+final_customer+'">'+customer_name+'</option>'
        $(".CustomerRow").append(options);
        $(".customerdetails").attr("title",customer_name);
        $(".customerdetails").attr("customerid",customer_id);
        var ShippingCharge=recordArr[customer].Pending_Delivery_Charges;
        if (oldCreditAmount<0)
        {
        	$(".old_credit_amount").text(parseFloat(oldCreditAmount * -1).toFixed(2));
        }
		if (oldCreditAmount_sweet<0)
        {
        	$(".old_credit_amount_sweet").text(parseFloat(oldCreditAmount * -1).toFixed(2));
        }

        if (brandVal.trim() == "Pasumpal Ice cream")
        {
        	$(".old_shipping_charge").text(ShippingCharge);
        	console.log("********");
        }
        else
        {
        	console.log("%%%%%%%");
        	$(".old_shipping_charge").text("0.00");
        }

        CheckTimeFunc(customer_id);
        // OutStandingPOFunc(customer_id);
        return {"customerid":customer_id,"area":customerLocation};
        $(".loader_div").hide();
      }
    }
	}
	// Check outstanding PO order part
	async function CheckTimeFunc(customerID){
		var d = new Date();
		var hours = d.getHours();
		var time = d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds();
		console.log(time);
		var ampm = hours >= 12 ? 'pm' : 'am';
		console.log("ampm:",ampm);
		// ampm="pm";
		let time_data = 1;
		if (1)
		{
			var givenTime = '12:00';
			var isGreater = isTimeGreaterThanCurrent(givenTime,"am");
			if (1)
			{
				$(".enabledisable").removeClass("overlay");
				OutStandingPOFunc(customerID);
				// $(".loader_div").hide();
			}
			else
			{
				$(".enabledisable").addClass("overlay");
				Swal.fire({
				  position: 'center',
				  icon: 'warning',
				  title: 'Try to Place Order After 9 PM',
				  showConfirmButton: false,
				  timer: 1500
				})
				$(".loader_div").hide();
			}
		}
		else if (1)
		{
			var givenTime = '18:00';
			var isGreater = isTimeGreaterThanCurrent(givenTime,"pm");
			console.log("isGreater",isGreater);
			if (1)
			{
				$(".enabledisable").removeClass("overlay");
				OutStandingPOFunc(customerID);
			}
			else
			{
				$(".enabledisable").addClass("overlay");
				Swal.fire({
				  position: 'center',
				  icon: 'warning',
				  title: 'Try to Place Order After 9 PM',
				  showConfirmButton: false,
				  timer: 1500
				})
				$(".loader_div").hide();
			}
		}
	}


	async function OutStandingPOFunc(customerID){
		console.log("OutStandingPOFunc called customerID:",customerID);
		try
    {
    	var custConfig={
				reportName : "All_Franchisees",
				id:customerID
			}
			const cust_response = await ZOHO.CREATOR.API.getRecordById(custConfig);
	    const recordArr = await cust_response.data;
	    var responsecode=cust_response.code;
	    return recordArr;
    }
    catch(errorRes)
    {
      console.log("errorRes:",errorRes);
      $(".enabledisable").removeClass("overlay");
      $(".loader_div").hide();
      return true;
    }
	}
	// Check outstanding PO order part ends here

	// Create Orders Part Starts
	async function CreateOrderFunc(MapData){
		console.log("CreateOrderFunc MapData:",MapData);
		var brandtype=$(".brandtype option:selected").text() || "Sweets & Savouries";
  	console.log("brandtype:",brandtype);
  	var createconfig={formName:"Order",data:MapData};
		const orderresponse = await ZOHO.CREATOR.API.addRecord(createconfig);
		var jasonstring = JSON.stringify(orderresponse);
		var formattedString = '"' + jasonstring + '"';
		console.log("orderresponse:",orderresponse);
		console.log("formattedString:", formattedString);
		var formData = {};
		var data = {};
		data.Data = formattedString;
		formData.data = data;
  	const recordArr = await orderresponse.data;
	  var responsecode=orderresponse.code;
	  if (responsecode==3000)
		{
			var order_ID = orderresponse.data.ID;
			config = {
		        		appName : "order-management",
						reportName : "All_Orders",
						id: order_ID,
						data : formData
						}

				//update record API
				ZOHO.CREATOR.API.updateRecord(config).then(function(response){
					if(response.code === 3000)
					{
						console.log("data stored on creator")
					}
			$(".loader_div").hide();
			$('.paid-btn').prop('disabled', false); 
	  	Swal.fire({
	      icon: 'success',
	      title: 'Order placed successfully !',
	      showCancelButton: true,
	      showConfirmButton: true,
	      cancelButtonColor: 'red',
	      confirmButtonColor:'green',
	      confirmButtonText:'Okay',
		  allowOutsideClick: false
	    }).then((result) => {
	      if (result.isConfirmed){
	        $('#cart-items >tbody >tr').remove();
	        var cartCount = $('.count').text();
	        $('.item-count').text(0);
	        if (cartCount >= 0){
	          $('.addtoCart').removeAttr('style');
	        }
	        $(".cart-bag").hide('close');
	        location.reload();
	        // window.open("https://creatorapp.zoho.in/info_nkcfoods/order-management/#Report:My_Orders_Report","_top")
	        window.location.replace(window.location.href+'?reload');

	        update_amounts();
	      } 
		  else if (result.dismiss === Swal.DismissReason.cancel) {
             location.reload();
			}  
	    });
	  });
	}
}
	// Create Orders Part Ends 
	// function related to creator part ends here

	$(document).ready(function(){

		// get Datas from creator Application
		ZOHO.CREATOR.init().then(function(){
			var query_params = ZOHO.CREATOR.UTIL.getQueryParams();
			// product function called
			// getProductFunc("Sweets & Savouries");
		});
		// get Datas from creator Application ends

  	//change selectboxes to selectize mode to be searchable
	 	$("#select_page").select2();
	  $(".bi-cart,.btn-warning").click(function(){
	    $('.cart-bag').show();
    });
   	$(".bi-arrow-left,.back-to-card").click(function(){
	    $('.cart-bag').fadeOut(300);
    });
   	// search to get items
   	$('.searchBar').on('keyup keypress',function(){
		  var filterContainer = $('.parentFilter');
		  var value = $(this).val().toLowerCase();
	    
	    var filteredItems = filterContainer.filter(function(){
        return $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
	    });
	    $('.searchBar').on('search', function() {
        $('.parentFilter').show();
	    });
		});

		// onload quantity notify
	  var cartItemLength =$('#cart-items >tbody >tr').length;
	  $('.item-count').text(cartItemLength);

	  // select the product item by click add to cart button

 		$(document).delegate('.addtoCart', 'click', function(){

	    var container = $(this).closest('.productCard');
	    var productName = container.find('.productName').text();
	    var price = container.find('.productPrice').text();
	    var actPrice = price.slice(3);
	    var ProductImg = container.find('.productImage img').attr('src');
	    var productQty = container.find('.qty').val();
	    console.log("productQty:",productQty);

	    var Available_Stock=container.find(".astock").text();
	    console.log("Available_Stock:",Available_Stock);
	    Available_Stock = Available_Stock.replace(/[^0-9]/g,"");
	    console.log("Available_Stock:",Available_Stock);
	    var MaxQty=container.find('.productName').attr("maxqty");
	    console.log("MaxQty",MaxQty)
	    // maxOrderQty=0;

	    if (parseInt(productQty)!=0)
	    {
	    // 	if (parseFloat(Available_Stock) < parseFloat(productQty))
	    // 	{
	    // 		Swal.fire({
					//   position: 'center',
					//   icon: 'warning',
					//   title: 'Entered Qty is more than Available Stock',
					//   showConfirmButton: false,
					//   timer: 2500
					// })
	    // 	}
	    // 	else
	    // 	{

	    		if (parseFloat(MaxQty) < parseFloat(productQty))
	    		{

	    			Swal.fire({
					    title: 'Are you sure?',
					    text: "Maximum Order Quantity is "+MaxQty,
					    icon: 'question',
					    showCancelButton: true,
					    confirmButtonColor: 'green',
					    cancelButtonColor: 'black',
					    confirmButtonText: 'Proceed'
					  }).then((result) => {
					    if (result.isConfirmed) {
					    	$(this).html("Added");
				    		// console.log(price);
						    var recordID=container.find(".productName").attr("recid");
						    var recSku=container.find(".productName").attr("sku");
						    console.log("recordID:",recordID);
						    console.log("recSku:",recSku);
						    var cartBtn = container.find('.addtoCart');
						    var tickBtn = container.find('.tick-icon');
						    tickBtn.css(
						    {
						      'display':'block',
						      'font-size':'.9rem',
						      'color':'white'
						    }); 
						    cartBtn.css(
						    {
						      'background':'green',
						      'color':'white',
						      'cursor':'pointer',
						      'border-radius':'18px',
						      // 'filter':'blur(.5px)',
						      // 'font-size':'.8rem',
						      'pointer-events': 'none'
						    });
						    $('.tick-icon').fadeOut(3000);
						    // append the items to item cart
						    var cartItems ='<tr class="line_item"><td width=12%><img src='+ProductImg+' /></td><td width=30% ><p class="name" recid='+recordID+'>'+productName+'</p></td><td ><p style="font:bold;font-weight: 580">INR<span class="current-price">'+actPrice+'</span></p></td><td><p class="cart-qty" sku='+recSku+'>'+productQty+'&nbsp;<span style="font:bolder;font-weight: 560;font-size: .8rem;">Kg</span></p></td><td><p style="font:bold;font-weight:690;" >INR<span class="full-price" style="text-align:right;margin-left:2px;">500</span></p></td><td><button class="btn btn-danger btn-sm cancel"><i class="bi bi-x"></i></button></td></tr>';
						    $('#cart-items #cart-body').append(cartItems);
						   	update_amounts();
						  }
					  });
	    		}
	    		else
	    		{
	    			$(this).html("Added");
		    		// console.log(price);
				    var recordID=container.find(".productName").attr("recid");
				    var recSku=container.find(".productName").attr("sku");
				    console.log("recordID:",recordID);
				    console.log("recSku:",recSku);
				    var cartBtn = container.find('.addtoCart');
				    var tickBtn = container.find('.tick-icon');
				    tickBtn.css(
				    {
				      'display':'block',
				      'font-size':'.9rem',
				      'color':'white'
				    }); 
				    cartBtn.css(
				    {
				      'background':'green',
				      'color':'white',
				      'cursor':'pointer',
				      'border-radius':'18px',
				      // 'filter':'blur(.5px)',
				      // 'font-size':'.8rem',
				      'pointer-events': 'none'
				    });
				    $('.tick-icon').fadeOut(3000);
				    // append the items to item cart
				    var cartItems ='<tr class="line_item"><td width=12%><img src='+ProductImg+' /></td><td width=30% ><p class="name" recid='+recordID+'>'+productName+'</p></td><td ><p style="font:bold;font-weight: 580">INR<span class="current-price">'+actPrice+'</span></p></td><td><p class="cart-qty" sku='+recSku+'>'+productQty+'&nbsp;<span style="font:bolder;font-weight: 560;font-size: .8rem;">Kg</span></p></td><td><p style="font:bold;font-weight:690;" >INR<span class="full-price" style="text-align:right;margin-left:2px;">500</span></p></td><td><button class="btn btn-danger btn-sm cancel"><i class="bi bi-x"></i></button></td></tr>';
				    $('#cart-items #cart-body').append(cartItems);
				   	update_amounts();

	    		}
	    	// }
	    } 
	    else
	    {
	    	Swal.fire({
				  position: 'center',
				  icon: 'warning',
				  title: 'Enter Minimum 1 Qty to Add',
				  showConfirmButton: false,
				  timer: 2500
				})
	    }
	 	});

	 	$(document).delegate('.qty , .current-price, .discount ,.pay-amount,.item-count, .cancel, .btn-minus, .btn-plus', 'keyup keypress blur change', function(){
	 		// alert("********");
    	update_amounts();
    	var discount = $('.discount').val();
    	var subTotal = $('.sub-total').text();
    	var total = parseFloat(discount / 100) * parseInt(subTotal);
    	var actualAmount = subTotal-total;
    	$('.total-Amount').text(actualAmount.toFixed(2));
    	$('.pay-amount').text(actualAmount.toFixed(2));
    	$('.item-count').text(cartItemLength);
  	});


  	$(document).delegate('.qty', 'keyup', function(){
  		// alert("******");
  		var container = $(this).closest('.productCard');
	    var updateQty=$(this).parent('.qty-section').find('.qty').val();
	    console.log("updateQty:",updateQty);
	    var recID = container.find('.productName').attr("recid");
	    console.log("recID:",recID);
	    var tbl_items = $("#cart-items").find(".line_item");
	    for (var i = 0; i < tbl_items.length; i++)
	  	{
	  		var recordID=tbl_items.eq(i).find(".name").attr("recid");
	  		console.log("recordID:",recordID);
	  		if (recordID===recID)
	  		{
	  			var price=tbl_items.eq(i).find(".current-price").text();
	  			tbl_items.eq(i).find(".cart-qty").html(updateQty+'&nbsp;<span style="font:bolder;font-weight: 560;font-size: .8rem;">Kg</span>');
	  		}
	  	}
	    update_amounts();
  	});

    // cancel each row
    $(document).delegate('.cancel', 'click', function(){

    	var row=$(this).closest('tr');
      var item_name=row.find(".name").text();
      console.log("TableProduct:",item_name);
      $(".productCard").each(function () {
        var keyValue=$(this).find(".productName").html();
        console.log("keyValue:",keyValue);
        var res=keyValue.includes(item_name);
        console.log("res:",res);
        if (res)
        {
          $(this).children().find(".addtoCart").html("Add to Cart");
          // $(this).find(".qty").val("0");
          var cartBtn=$(this).children().find(".addtoCart");
          cartBtn.removeAttr('style');
        }
      });

      $(this).closest('tr').remove();	
      // alert("cancel btn clicked");
      var cartItemLength =$('#cart-items >tbody >tr').length;
      $('.item-count').text(cartItemLength);
      update_amounts();
    });
	});

	// clear all row of cart items
	$('.clear-btn').on('click',function(){
	  console.log("listVal:",listVal);
	  Swal.fire({
	    title: 'Are you sure?',
	    text: "do you want to clear the all items",
	    icon: 'warning',
	    showCancelButton: true,
	    confirmButtonColor: 'green',
	    cancelButtonColor: 'black',
	    confirmButtonText: 'Yes, Clear!'
	  }).then((result) => {
	    if (result.isConfirmed) {
	    	var tbl_items = $("#cart-items").find(".line_item");
	    	for (var i = 0; i < tbl_items.length; i++)
	    	{
	    		var recordID=tbl_items.eq(i).find(".name").attr("recid");
	    		const dataqty = findArrayByKeyValue('productID', recordID, listVal);
    			console.log("dataqty:",dataqty);
    			if (!dataqty)
    			{
    				console.log(tbl_items.eq(i).closest("tr"));
    				tbl_items.eq(i).closest("tr").remove();
    				update_amounts();
    			}
	    	}

	    	// Swal.fire(
		    //   'Cleared!',
		    //   'Cart items cleared..',
		    //   'success'
	     //  )
		    // $('#cart-items >tbody >tr').remove();
		    var itemLength = $('#cart-items >tbody >tr').length;
		    $('.item-count').text(itemLength);
		    if (itemLength >= 0){
		      $('.addtoCart').removeAttr('style');
		      $(".addtoCart").html("Add to Cart");
		    }
		    // $('.sub-total').text(itemLength.toFixed(2));
		    // $('.total-Amount').text(itemLength.toFixed(2));
		    // $('.pay-amount').text(itemLength.toFixed(2));
		    $(".cart-bag").hide('close');
		    // window.location.replace(window.location.href+'?reload');
		  }
	  });
	});
  // adding new customer with swal
 	$('.adding-customer').on('click',function(){
	  Swal.fire({
      icon: 'success',
      title: "You've got a new customer .!",
      showConfirmButton: false,
      timer: 1500
	  }).then((customerAdd)=>{
     	if(customerAdd !=0){
	      $('.cancel-adding').trigger('click');
     	}
	  });
         
  });
 	// Paid button sweet alert automation
  $('.paid-btn').on('click',function(){
	
  	var tbl_itemslen = $("#cart-items").find(".line_item");
  	console.log("tbl_itemslen:",tbl_itemslen);
  	if (tbl_itemslen.length>0)
  	{
		$('.paid-btn').prop('disabled', true); 
  		$(".loader_div").show();
	  	var customerID=$(".customerdetails").attr("customerid");
	  	var brandtype=$(".brandtype option:selected").text() || "Sweets & Savouries";
	  	console.log("brandtype:",brandtype);

	  	var tbl_items = $("#cart-items").find(".line_item");
	  	var linedata=[];
	  	for (var i = 0; i < tbl_items.length; i++)
	  	{
	  		var productName=tbl_items.eq(i).find(".name").text();
	  		var sku=tbl_items.eq(i).find(".name").text();
	  		var recordID=tbl_items.eq(i).find(".name").attr("recid");
	  		var price=tbl_items.eq(i).find(".current-price").text();
	  		var qty=tbl_items.eq(i).find(".cart-qty").text();
	  		qty = qty.replace(/[^0-9]/g,"");
	  		var sku=tbl_items.eq(i).find(".cart-qty").attr("sku");
	  		var linetotal=tbl_items.eq(i).find(".full-price").text();
	  		var serialNumber=i+1;
	  		let temp_obj={
	  		"S_No":serialNumber,
	        "Item":recordID,
	        "SKU":sku,
	        "Quantity":qty,
	        "Price":price,
	        "Total_Amount":linetotal
	      }
	      linedata.push(temp_obj);
	  	}

	  	var subTotal=$(".sub-total").text();
	  	var discount=$(".discount").val();	
	  	var discount_val=(parseFloat(subTotal) * discount)/100;

	  	var finaltotal=$(".total-Amount").text();
	  	var MapData={
	  		"data":{
	  			"Customer_Name":customerID,
	  			"Brand_Type":brandtype,
	  			"Status":"Order Open",
	  			"Invoice_Status":"Pending",
	  			"Modify_Status":"No",
	  			"Items":linedata,
	  			"Sub_Total":subTotal,
	  			"Discount":discount_val,
	  			"Total":finaltotal
	  		}
	  	};
	  	OutStandingPOFunc(customerID).then(data=>{
	  		console.log("data",data);
		    var OutStandingAmount=data.OutStanding_Amount || 0;
			var OutStandingAmount_sweet = data.Sweets_Savouries_Outstanding_Amount || 0;
		    var customerLocation=data.Location;
		    var creditoption=data.Enable_Outstanding;
		    var customerCreditAmount=data.Available_Credit;
		    var boxoutstanding=data.Box_Outstanding || "True";
			console.log("OutStandingAmount_sweet",OutStandingAmount_sweet);
		    console.log("OutStandingAmount:",OutStandingAmount);
		    console.log("creditoption:",creditoption);
		    // boxoutstanding validation part
		    if (boxoutstanding == "True")
		    {
		    	// OutStandingAmount validation part
		    	if (OutStandingAmount <= 0 || OutStandingAmount_sweet <= 0)
		    	{
		    		console.log("create order");
		    		CreateOrderFunc(MapData);
		    	}
		    	else
		    	{
		    		// customerLocation validation part
		    		if (customerLocation=="LOCAL" || creditoption== "true")
		    		{
		    			// creditoption and amount validation part
		    			if (finaltotal<=customerCreditAmount)
		    			{
		    				MapData.data["Credit_Amount"]=finaltotal;
	  						CreateOrderFunc(MapData);
	  						console.log("create order");
		    			}
		    			else
		    			{
		    				$(".loader_div").hide();
		    				Swal.fire({
								  position: 'center',
								  icon: 'warning',
								  text:"Total Amount is more than Credit Amount",
								  showConfirmButton: false,
								  timer: 2600
								})
		    			}
		    			// creditoption and amount validation part ends here
		    		}
		    		else
		    		{
		    			$(".loader_div").hide();
		    			Swal.fire({
							  position: 'center',
							  icon: 'warning',
							  title: 'OutStanding Amount Found',
							  text:"Out Standing Amount is: "+OutStandingAmount,
							  showConfirmButton: false,
							  timer: 2500
							})
		    		}
		    		// customerLocation validation part ends here
		    	}
		    	// OutStandingAmount validation part ends here
		    }
		    else
		    {
		    	$(".loader_div").hide();
		    	$(".enabledisable").addClass("overlay");
					Swal.fire({
					  position: 'center',
					  icon: 'warning',
					  text:"Some boxes need to be returned",
					  showConfirmButton: false,
					  timer: 2500
					})
		    }
		    // boxoutstanding validation part ends here
	  	});
  	}
  	else
  	{
  		Swal.fire({
			  position: 'center',
			  icon: 'error',
			  title: 'Found Empty Cart',
			  showConfirmButton: false,
			  timer: 1500
			})
  	}
  });

	// increment and decrement the input number button value 
  $(document).delegate('.btn-plus', 'click', function(){
  	// alert("button clicked");
  	var container = $(this).closest('.productCard');
  	var $n = $(this).parent('.qty-section').find('.qty');
    $n.val(Number($n.val())+1);
    var updateQty=$(this).parent('.qty-section').find('.qty').val();
    console.log("updateQty:",updateQty);
    var recID = container.find('.productName').attr("recid");
    console.log("recID:",recID);
    var tbl_items = $("#cart-items").find(".line_item");
    for (var i = 0; i < tbl_items.length; i++)
  	{
  		var recordID=tbl_items.eq(i).find(".name").attr("recid");
  		console.log("recordID:",recordID);
  		if (recordID===recID)
  		{
  			var price=tbl_items.eq(i).find(".current-price").text();
  			tbl_items.eq(i).find(".cart-qty").html(updateQty+'&nbsp;<span style="font:bolder;font-weight: 560;font-size: .8rem;">Kg</span>');
  		}
  	}
    update_amounts();
  });
  $(document).delegate('.btn-minus', 'click', function(){
  	var container = $(this).closest('.productCard');
  	var $n = $(this).parent('.qty-section').find('.qty');
    var qtyVal = Number($n.val());
    if(qtyVal > 1){
      $n.val(qtyVal-1);
      var updateQty=$(this).parent('.qty-section').find('.qty').val();
	    console.log("updateQty:",updateQty);
	    var recID = container.find('.productName').attr("recid");
	    console.log("recID:",recID);
	    var tbl_items = $("#cart-items").find(".line_item");
	    for (var i = 0; i < tbl_items.length; i++)
	  	{
	  		var recordID=tbl_items.eq(i).find(".name").attr("recid");
	  		// console.log("recordID:",recordID);
	  		if (recordID===recID)
	  		{
	  			var price=tbl_items.eq(i).find(".current-price").text();
	  			tbl_items.eq(i).find(".cart-qty").html(updateQty+'&nbsp;<span style="font:bolder;font-weight: 560;font-size: .8rem;">Kg</span>');
	  		}
	  	}
    }
    update_amounts();
  });
  // increment and decrement the input number button value ends here

	// tabel row automation
	function update_amounts(){
	  var sum=0.0;
	  $('#cart-items > tbody > tr').each(function(index){
	    var qty = $(this).find('.cart-qty').text();
	    let actualQty = qty.slice(0,-2);
	    // console.log(actualQty);
	    var c_price = $(this).find('.current-price').text();
	    var total_price = (actualQty*c_price);
	    sum+=total_price;
	    $(this).find('.full-price').text(''+parseFloat(total_price).toFixed(2));
	    var rowCount =index+1;
	    $('.item-count').text(rowCount);
	  });

	  $('.sub-total').text(sum.toFixed(2));
	  $('.total-Amount').text(sum.toFixed(2));

	  var oldCreditAmount=$(".old_credit_amount").text();
	  var oldCreditAmount_sweet =$(".old_credit_amount_sweet").text();
	  var oldshippingcharge=$(".old_shipping_charge").text();
	  // console.log("oldCreditAmount",oldCreditAmount);
	  // console.log("oldCreditAmount_sweet",oldCreditAmount_sweet);
	  var paymentAmount=parseFloat(sum)+ parseFloat(oldshippingcharge);
	  if (oldCreditAmount > paymentAmount)
	  {
	  	var payamount=0;
	  	$('.pay-amount').text(payamount.toFixed(2));
	  }
	  else
	  {
	  	var payamount=parseFloat(paymentAmount) - parseFloat(oldCreditAmount);
	  	$('.pay-amount').text(payamount.toFixed(2));
	  }
	  if (oldCreditAmount_sweet  > paymentAmount)
	  {
	  	var payamount=0;
	  	$('.pay-amount').text(payamount.toFixed(2));
	  }
	  else
	  {
	  	var payamount=parseFloat(paymentAmount) - parseFloat(oldCreditAmount);
	  	$('.pay-amount').text(payamount.toFixed(2));
	  }
	}

	// tooltip function
	$(function () {
  $('[data-toggle="tooltip"]').tooltip()
});
</script>
</html>
